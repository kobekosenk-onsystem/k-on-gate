<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>K-on! System Loading</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <div style="text-align:center; padding-top:50px; font-family:sans-serif;">
    <p>ログインを確認中...</p>
  </div>
  <script>
    // 設定値
    const LIFF_ID = "2008880240-ln3wSnTk"; 
    const GAS_URL = "https://script.google.com/macros/s/AKfycbz4i_QH_gP71TTE7iUnSzTdNVyufk4Jydaz_RkBWFfezI0l7rZZ_P-J7ct8hcyT1GfLyg/exec";

    window.onload = function() {
      liff.init({ liffId: LIFF_ID }).then(() => {
        if (!liff.isLoggedIn()) {
          liff.login(); // ログインしていなければLINEのログイン画面へ
        } else {
          liff.getProfile().then(p => {
            // LINE IDを取得したら、GASのURLにパラメータとして付けてリダイレクト
            // ここで Google のログイン壁をバイパスします
            window.location.replace(GAS_URL + "?uid=" + p.userId);
          });
        }
      }).catch(err => document.write("LIFF Error: " + err));
    };
  </script>
</body>
</html>
